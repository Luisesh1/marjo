wb = xlsx_package.workbook
  wb.styles do |style|
    highlight_cell = style.add_style(bg_color: "FFFF00")
    wb.add_worksheet(name: "clientes") do |sheet|
      sheet.add_row [@sucursal.nombre] unless @sucursal.nil?
      sheet.add_row [""]
      sheet.add_row [
      "SUCURSAL",
     "EMPRESA",
     "APELLIDO PATERNO",
     "APELLIDO MATERNO",
     "NOMBRE",
     "NOMBRE ADICIONAL",
     "DOMICILIO PARTICULAR",
     "PAIS DOMICILIO",
     "ESTADO DOMICILIO",
     "COLONIA",
     "NUM EXTERIOR",	
     "NUM INTERIOR",
     "CODIGO POSTAL",
     #"ANT DEL DOMICILIO",
     "RFC",
     "CURP",
     "TELEFONO PARTICULAR",
     "TELEFONO OFICINA",
     "TELEFONO CELULAR",
     "NACIONALIDAD",
     "EMAIL",
     "SEXO",
     "CLIENTE DESDE",
     "N. DE DEPENDIENTES ECONOMICOS",
     "GASTO MENSUAL",
     "ESTADO CIVIL",
     "NOMBRE CONYUGUE",
     "TELEFONO CONYUGUE",
     "TELEFONO OFICINA CONYUGUE",
     "PAIS DE NACIMIENTO",
     "ESTADO DE NACIMIENTO",
     "CIUDAD DE NACIMIENTO"	,
     "NACIONALIDAD",
     "FECHA DE NACIMIENTO",
    # "FECHA DE INGRESO AL TRABAJO",
     "EMPRESA DONDE LABORA",
     "TELEFONO EMPRESA",
     "DIRECCION EMPRESA",
     "COLONIA EMPRESA",
     "MUNICIPIO EMPRESA",
    # "ANTIGUEDAD EN LA EMPRESA",
    # "PUESTO",
     "PROFESION",
     "OCUPACION"	,
     "SUELDO MENSUAL",
     "NUMERO DE SEGURO SOCIAL",
   #  "FIEL",
   #  "PARA QUE NECESITA EL CREDITO",
     "NOMBRE REFERENCIA",
     "DOMICILIO REFERENCIA",
     "TELEFONO REFERENCIA",
     "TELEFONO CELULAR REFERENCIA",
     "NOMBRE REFERENCIA 2",
     "DOMICILIO REFERECIA 2",
     "TELEFONO REFERENCIA 2",
     "TELEFONO CELULAR REFERENCIA 2",
     "NOMBRE FAMILIAR",
     "DOMICILIO FAMILIAR",
     "TELEFONO FAMILIAR",
     "TELEFONO CELULAR FAMILIAR"],style: [ highlight_cell,highlight_cell,highlight_cell,highlight_cell,highlight_cell,highlight_cell]
     
       @customers.each do |customer|
        ultimo_credito = customer.credits.select(:id).where("status = 1 or status = 3").last
        clientes = ""
        customer.credits.select(:id,:fecha_de_contrato).where("status = 1 or status = 3").order(:fecha_de_contrato).each do |credit|
            clientes = clientes + "#{credit.fecha_de_contrato.strftime("%m/%d/%Y")}(#{credit.calificacion}), " unless credit.fecha_de_contrato.nil?
        end
        #sheet.add_row [customer.padre.branch_office.nombre,customer.padre.nombre_completo,customer.nombre_completo_deudor,(ultimo_credito.nil?)? "" : ultimo_credito.calificacion,customer.credits.where("status = 1 or status = 3").select(:id).count,clientes]
        sheet.add_row [customer.padre.sucursal.nombre]
      end
    end
  end